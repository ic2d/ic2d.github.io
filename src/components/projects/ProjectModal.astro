---
import '@styles/global.css';

import type { Project } from '@scripts/interfaces';

/**
 * Componente representativo de um modal para exibir detalhes de um projeto.
 * Agrupa o botão visível para abrir o modal e o conteúdo do modal em si.
 * Exibe informações detalhadas do projeto em um modal que pode ser aberto e fechado.
 * @param {Object} props - As propriedades do componente.
 * @param {Project} [props.project] - O objeto do projeto contendo suas informações.
 * @param {string} [props.id] - O ID único para o modal, utilizado para controle de abertura e fechamento.
 */
interface Props{
    project: Project;
    id: string;
}

const { project, id } = Astro.props;
---

<div class="modal-block column">
    <button type="button" class="modal-facade">
        <h5>{project.name}</h5>
        <p>Professores: {project.professors.join(', ')}</p>
        <em>Áreas de pesquisa: {project.research_areas.join(', ')}</em>
    </button>

    <div id={id} class="modal-popup">
        <div class="popup-content">
            <hgroup>
                <span class="close">&times;</span>
                <h5>{project.name}</h5>
                <p>Professores: {project.professors.join(', ')}</p>
                <em>Áreas de pesquisa: {project.research_areas.join(', ')}</em>
            </hgroup>
            <br>
            <p class="popup-desc">
                {project.description}
            </p>
        </div>
    </div>
</div>

<!-- =============================================================================================== -->

<script>

const modals = document.querySelectorAll('.modal-block');

/**
 * Adiciona funcionalidade de abrir e fechar modais de projetos.
 * Cada modal é controlado por um botão que abre o modal e um elemento de fechamento.
 * O modal pode ser fechado clicando no botão de fechar ou clicando fora do conteúdo do modal.
 */
modals.forEach(modal=>{
    const popup = modal.querySelector('.modal-popup') as HTMLDivElement;
    
    modal.querySelector('button')?.addEventListener('click',()=>{
        popup.classList.add("open");
    });

    popup.querySelector('.close')?.addEventListener('click',()=>{
        popup.classList.remove("open");
    });

    popup.addEventListener('click', (e) => {
        if (e.target === popup) {
            popup.classList.remove('open');
        }
    });
});

</script>

<!-- =============================================================================================== -->

<style>
/* Geral */
.modal-block {
    margin-bottom: calc(var(--gutter-lg) * 2);
}

/* Facade - Geral */
.modal-facade {
    display: block;
    background-color: var(--color-gray-16);
    border-radius: 15px;
    border: none;

    -webkit-transition: all .5s;
    transition: all .5s;

    -webkit-box-shadow: 0px 0px 16px var(--color-gray-15);
    box-shadow: 0px 0px 16px var(--color-gray-15);

    text-align: center;
    width: min(700px, 100%);    
    height: 300px;
    padding: 10px 50px 15px 50px;

    cursor: pointer;
}

.modal-facade h5{
    color: var(--color-1);
    margin-top: 10px;
}

.modal-facade p{
    color: var(--color-text-light);
    font-size: var(--text-sm);
    margin-bottom: 10px;
}

.modal-facade em{
    color: var(--color-text);
    font-size: var(--text-sm);
    margin-bottom: 1px;
}

.modal-facade:hover, .modal-facade:focus {
    background-color: var(--color-dark-bg);
}

.modal-facade:hover,
.modal-facade:focus {
    color: var(--color-white);
}

/* Popup - Geral */
.modal-popup {
    position: fixed;
    z-index: 9999;
    inset: 0;
    display: grid;
    place-items: center;

    background-color: var(--color-dark-fade-bg);

    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.modal-popup.open {
    opacity: 1;
    pointer-events: auto;
}

/* Popup - Botão de fechamento */
.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
  margin-left: 10px;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

/* Popup - Conteúdo */
.popup-content {
    background-color: var(--color-gray-16);
    padding: 30px 40px 40px 40px;
    border: 1px solid var(--color-gray-19);
    border-radius: 15px;
    width: min(80%, 700px);

    transform: translateY(20px) scale(0.80);
    opacity: 0;
    transition: all 0.3s ease;
}

.modal-popup.open .popup-content {
    transform: translateY(0) scale(1);
    opacity: 1;
}

/* Popup - Cabeçalho */
.popup-content hgroup h5{
    color: var(--color-1-dark);
    margin-top: 0;
}

.popup-content hgroup p, em{
    color: var(--color-text);
    text-align: justify;
    margin-bottom: 5px;
}

/* Popup - Texto */
.popup-content .popup-desc{
    color: var(--color-text-light);
}

/* Responsividade */
@media screen and (max-width: 1200px) {
    .modal-block{
        justify-items: center;
    }
}
</style>